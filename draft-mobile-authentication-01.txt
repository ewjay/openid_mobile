



                                                             J. Connotte
                                                     Deutsche Telekom AG
                                                              J. Bradley
                                                           Ping Identity
                                                            Nov 22, 2015


            OpenID Connect Mobile Authentication Profile 1.0
                     draft-mobile-authentication-01

Abstract

   RPs are keen to use high quality authentication methods which can be
   provided by the MNOs.  However a RP must be able to describe its
   demands for an authentication request and it must be able to do this
   interoperable.

   The MODRNA Profile will specify how RP's request a certain level of
   assurance for the authentication.  We propose to use the definition
   of Level of Assurance as specified in [6] as a starting point and
   define respective normative ACR values.

   In addition the profile will specify an encrypted login hint to allow
   for the transport of identifiers to the OP.

   Lastly the profile will specify an additional context parameter
   intended to serve as an interlock between the user's consumpution
   device and authentication device.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Notation and Conventions . . . . . . . . . .   2
     1.2.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Authentication Request  . . . . . . . . . . . . . . . . . . .   3
   4.  acr_values request values and level of assurance  . . . . . .   3
   5.  login_hint_token  . . . . . . . . . . . . . . . . . . . . . .   5
     5.1.  login_hint_token encryption and signing . . . . . . . . .   6
   6.  context . . . . . . . . . . . . . . . . . . . . . . . . . . .   6
     6.1.  context security  . . . . . . . . . . . . . . . . . . . .   6
   7.  mandatory to implement  . . . . . . . . . . . . . . . . . . .   7
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .   7
   9.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   7
   10. IANA Considerations . . . . . . . . . . . . . . . . . . . . .   7
   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .   7
     11.1.  Normative References . . . . . . . . . . . . . . . . . .   7
     11.2.  Informative References . . . . . . . . . . . . . . . . .   8



Connotte & Bradley        Expires May 25, 2016                  [Page 1]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .   8
   Appendix B.  Notices  . . . . . . . . . . . . . . . . . . . . . .   8
   Appendix C.  Document History . . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   9

1.  Introduction

   OpenID Connect Mobile Authentication Profile 1.0 is a profile of the
   OpenID Connect Core 1.0 [OpenID.Core] specification that defines
   common authentication contexts to be used across MNO and Mandatory to
   Implement features for MNO to assure interoperability of clients
   across MNO.

1.1.  Requirements Notation and Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   Throughout this document, values are quoted to indicate that they are
   to be taken literally.  When using these values in protocol messages,
   the quotes MUST NOT be used as part of the value.

1.2.  Terminology

   This specification uses the termn "OpenID Provider (OP)" and "Relying
   Party (RP)" as defined by OpenID Connect Core [OpenID.Core].  This
   specification also defines the following terms:

   Mobile Network Operator (MNO)  A provider of wireless communication
      services that owns or controls the wireless network elements
      necessary to sell and deliver services to an end user.

   Mobile Station International Subscriber Directory Number (MSISDN)  A
      telephone number uniquely identifying a subscription in a mobile
      network.

   Consumption Device (CD)  A user agent, most probably a browser, on
      which the user consumes the actual service provided by the Relying
      Party.

   Authentication Device (AD)  A mobile device on which the user will
      authenticate the actual login.








Connotte & Bradley        Expires May 25, 2016                  [Page 2]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


2.  Overview

   This specification serves as a profile based on OpenID Connect Core
   [OpenID.Core].  It defines additional request parameters in the
   Authentication Request.  It also specifies authentication class
   reference values based on the ISO/IEC DIS 29115 [ISO.29115] to be
   used for the acr_values request parameter

3.  Authentication Request

   MODRNA supports all request parameters as specified in OpenID Connect
   Core 3.1.2.1 [OpenID.Core]

   In addtion the following parameters are defined or made REQUIRED for
   clients to send.  All additional paramaters are REQUIRED for IdP to
   support.

   acr_values  REQUIRED.  For MODRNA the parameter is REQUIRED to enable
      the Relying Party to indicate a MODRNA conform authentication
      request.  Allowed values are defined in Section 4

   login_hint_token  OPTIONAL.  The login_hint_token is used to
      transport a user identifier from the discovery service to the
      OpenID Provider without revealing this identifier to the client.
      Section 5 specifies the structure of this parameter.  Protection
      of the login_hint_token's content is specified in Section 5.1.

   context  OPTIONAL.  Interlock message to tie the consumption device
      and the authentication device together.  How to ensure that the
      message is actually shown on all relevant devices is out of the
      scope of this document.  Possible values and constraints are
      specified in Section 6.  Ways to protect the integrity of the
      conext message are discussed in Section 6.1.

4.  acr_values request values and level of assurance

   The service terms of service will specify a trust framework for
   Identity Providers to follow for general business processes and other
   related account security issues.

   This specification defines initial "acr" values that clients can use
   to request the IdP mitigate specific authentication risks.

   In addition the initial set of "acr" values contain no requirements
   for the IdP to make any guarente of identity proofing the subject of
   the authentication beyond what is required by business practices for
   account recovery, and customer service as defined in the trust




Connotte & Bradley        Expires May 25, 2016                  [Page 3]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


   framework.  Prepaid anonymous users are included in responses
   conforming to these values.

   The IANA Level of Assurance (LoA) Profiles [RFC6711] Registry will be
   used to register the short names for these LoA, and any future
   additional LoA.

   http://schemas.openid.net/policies/mod/phishing-resistant  Short-
      Name: mod-pr
      This mitigates phishing of credentials.
      The user is authenticated via possession of a device (phone)
      containing a secret key.  The user is required to provide no
      additional authentication information to use the key.  The user is
      interactively prompted to confirm the authentication.  The storage
      mechanism for the secret key and other relevant authentication
      information is returned via the "amr".  The user is not re-
      prompted if prompt is not login and max_age is more than the
      elapsed time since the user last authenticated at this acr

   http://schemas.openid.net/policies/mod/multi-factor  Short-Name: mod-
      mf
      This mitigates phishing and proves the device is recently in the
      possession of the authorised user via pin or device unlock.
      The user is authenticated via possession of a device (phone)
      containing a secret key.  The user is required to provide
      additional authentication information via a biometric, pin code or
      other appropriate factors such as bluetooth paring with a watch.
      Given suitable Mobile device management unlocking the device is
      also sufficient along with user confirmation of desire to
      authenticate.  The storage mechanism for the secret key and other
      relevant authentication information is returned via the "amr"
      value.  The user is not re-prompted if prompt is not login and
      max_age is more than the elapsed time since the user last
      authenticated at this acr,

   http://schemas.openid.net/policies/mod/multi-factor-physical  Short-
      Name: mod-mfp
      This mitigates phishing and proves the device is currently in the
      possession of the authorised user verified by a biometric.
      The user is authenticated via possession of a device (phone)
      containing a secret key.  The user is required to provide
      additional authentication information via a local biometric, or a
      remote paring with a biometric capable device.  If an external
      device like a EKG band is used for the biometric the user must
      still be prompted for consent on the AD.  The Biometric may be
      captured as part of the consent flow.





Connotte & Bradley        Expires May 25, 2016                  [Page 4]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


   Identity Providers MUST recognize and process both the long URI and
   short registered forms of the authentication context strings.

   The OP MUST support receiving "acr_values" as a space separated list
   in order of preference per OpenID Connect Core 3.1.2.1 [OpenID.Core].

   The OP MUST also support receiving "acr" as a as a claim request in a
   signed request per OpenID Connect Core 5.5.1 [OpenID.Core].

   Depending on the authentication capabilities of the users device, the
   OP must attempt to match the highest requested acr value that the AD
   is capable of.  If the acr claim is not marked as essential in the
   request object, the OP may return another acr value that the device
   is capable of rather than an error if it cannot match any of the
   requested acr_values.

5.  login_hint_token

   The "login_hint_token" produced by the Discovery service is a Json
   Web Token JWT [RFC7519] that contains the following elements:

   iss  REQUIRED.  The party creating the token.  This value MUST be
      used to obtain the JWK [RFC7517] file required to validate the
      tokens's signature (see Section 5.1).

   aud  REQUIRED.  The party to receive the token, typically the users
      OpenID Provider.  The value SHOULD be the issuer URI of the OP as
      exposed in the openid-configuration.

   iat  REQUIRED.  When the token was issued.

   MSISDN  REQUIRED.  NUMERIC The Subscriber identifier TBD: according
      to what standard? - E.123 E.164

   The following is a non-normative example of JWT body (with line wraps
   within values for display purposes only):

     {
      "iss": "https://discovery-provider.com",
      "aud": "https://babytel.com",
      "iat": 1311280970,
      "MSISDN": "5555551212"
     }








Connotte & Bradley        Expires May 25, 2016                  [Page 5]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


5.1.  login_hint_token encryption and signing

   The login_hint token MUST be signed using the private key of the
   discovery service.

   The login_hint token MUST be encrypted using the public key of the
   OpenID Provider.

   It is best practice to sign then encrypt tokens, as signatures over
   encrypted information may leak information in the envelope, and may
   not be considered legally valid.

   For an example of a nested JWT that is signed and then encrypted see
   Appendix 2 of JWT [RFC7519].  TBD: add description on how to process/
   validate the signature From https://bitbucket.org
   /openid/mobile/issues/13/encrypted-login-hint.  Standard mechanism is
   described where? --> John

   NOTE: The "login_hint_token" is opaque to the client by design.  The
   Authorization server may produce "login_hint_token" tokens in other
   formats for use in Account Chooser or other discovery profiles, as
   long as they are confidentiality protected from the client.

6.  context

   The context parameter is a message provided by the RP an can be shown
   to the user on the consumption device as well as on the
   authentication device as an interlock between RP and OP.  The context
   SHOULD be displayable by all participating parties.

   The context message MUST be plain text using the "application/x-www-
   form-urlencoded" format as the authentication device in particular
   may have limited abilities to show text or formats.

   TBD: something about the length of the message? e.g. the message MUST
   be distingushable from the first 64 characters...

6.1.  context security

   To prohibit manipulation of the context parameter the RP SHOULD use
   the OpenID Connect Request Object.

   The Request Object SHOULD be signed as specified in section 6.3.2 of
   [OpenID.Core].

   The Request Object MAY the encrypted as specified in section 6.3.1 of
   [OpenID.Core].




Connotte & Bradley        Expires May 25, 2016                  [Page 6]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


7.  mandatory to implement

   acr_values  All MODRNA compliant OP's MUST accept the acr_values
      specified in Section 4

8.  Security Considerations

   TBD

9.  Privacy Considerations

   TBD

10.  IANA Considerations

   This document makes no requests of IANA.

   TBD: Find out about how to correctly add entries to IANA for:
   https://www.iana.org/assignment/loa-profiles/loa-profiles.xhtml

11.  References

11.1.  Normative References

   [OpenID.Core]
              Sakimura, N., Bradley, J., Jones, M., de Medeiros, B.,
              Mortimore, C., and E. Jay, "OpenID Connect Core 1.0",
              December 2013.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC6711]  Johansson, L., "An IANA Registry for Level of Assurance
              (LoA) Profiles", RFC 6711, DOI 10.17487/RFC6711, August
              2012, <http://www.rfc-editor.org/info/rfc6711>.

   [RFC7517]  Jones, M., "JSON Web Key (JWK)", RFC 7517,
              DOI 10.17487/RFC7517, May 2015,
              <http://www.rfc-editor.org/info/rfc7517>.

   [RFC7519]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", RFC 7519, DOI 10.17487/RFC7519, May 2015,
              <http://www.rfc-editor.org/info/rfc7519>.






Connotte & Bradley        Expires May 25, 2016                  [Page 7]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


11.2.  Informative References

   [ISO.29115]
              McAllister, E. and R. Brackney, "ISO/IEC DIS 29115", April
              2013.

   [OpenID.Discovery]
              Sakimura, N., Bradley, J., Jones, M., and E. Jay, "OpenID
              Connect Discovery 1.0", September 2014.

   [RFC2246]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              RFC 2246, DOI 10.17487/RFC2246, January 1999,
              <http://www.rfc-editor.org/info/rfc2246>.

   [RFC5246]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", RFC 5246,
              DOI 10.17487/RFC5246, August 2008,
              <http://www.rfc-editor.org/info/rfc5246>.

   [RFC6749]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              RFC 6749, DOI 10.17487/RFC6749, October 2012,
              <http://www.rfc-editor.org/info/rfc6749>.

   [RFC6750]  Jones, M. and D. Hardt, "The OAuth 2.0 Authorization
              Framework: Bearer Token Usage", RFC 6750,
              DOI 10.17487/RFC6750, October 2012,
              <http://www.rfc-editor.org/info/rfc6750>.

Appendix A.  Acknowledgements

   The following have contributed to the development of this
   specification.

      Matthieu Verdier (matthieu.verdier@orange.com), Orange

      Gonzalo Fernandez Rodriguez
      (gonzalo.fernandezrodriguez@telefonica.com), Telefonica

Appendix B.  Notices

   Copyright (c) 2015 The OpenID Foundation.

   The OpenID Foundation (OIDF) grants to any Contributor, developer,
   implementer, or other interested party a non-exclusive, royalty free,
   worldwide copyright license to reproduce, prepare derivative works
   from, distribute, perform and display, this Implementers Draft or
   Final Specification solely for the purposes of (i) developing
   specifications, and (ii) implementing Implementers Drafts and Final



Connotte & Bradley        Expires May 25, 2016                  [Page 8]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


   Specifications based on such documents, provided that attribution be
   made to the OIDF as the source of the material, but that such
   attribution does not indicate an endorsement by the OIDF.

   The technology described in this specification was made available
   from contributions from various sources, including members of the
   OpenID Foundation and others.  Although the OpenID Foundation has
   taken steps to help ensure that the technology is available for
   distribution, it takes no position regarding the validity or scope of
   any intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this specification or the extent to which any license under such
   rights might or might not be available; neither does it represent
   that it has made any independent effort to identify any such rights.
   The OpenID Foundation and the contributors to this specification make
   no (and hereby expressly disclaim any) warranties (express, implied,
   or otherwise), including implied warranties of merchantability, non-
   infringement, fitness for a particular purpose, or title, related to
   this specification, and the entire risk as to implementing this
   specification is assumed by the implementer.  The OpenID Intellectual
   Property Rights policy requires contributors to offer a patent
   promise not to assert certain patent claims against other
   contributors and against implementers.  The OpenID Foundation invites
   any interested party to bring to its attention any copyrights,
   patents, patent applications, or other proprietary rights that may
   cover technology that may be required to practice this specification.

Appendix C.  Document History

   [[ To be removed from the final specification ]]

   -01

   o  Initial draft

   o  Added OIDF Standard Notice

Authors' Addresses

   Joerg Connotte
   Deutsche Telekom AG

   Email: j.connotte@telekom.de








Connotte & Bradley        Expires May 25, 2016                  [Page 9]

                 OIDC Mobile Authentication Profile 1.0         Nov 2015


   John Bradley
   Ping Identity

   Email: jbradley@pingidentity.com















































Connotte & Bradley        Expires May 25, 2016                 [Page 10]
