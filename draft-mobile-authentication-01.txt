



                                                             J. Connotte
                                                                      DT
                                                              J. Bradley
                                                           Ping Identity
                                                            Dec 09, 2014


            OpenID Connect Mobile Authentication Profile 1.0
                     draft-mobile-authentication-01

Abstract

   RPs are keen to use high quality authentication methods which can be
   provided by the MNOs.  However a RP must be able to describe its
   demands for an authentication request and it must be able to do this
   interoperable.

   The Mobile Profile will specify how RP's request a certain level of
   assurance for the authentication.  We propose to use the definition
   of Level of Assurance as specified in [6] as a starting point and
   define respective normative ACR values.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Notation and Conventions . . . . . . . . . .   2
     1.2.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Level of Assurance as acr_values  . . . . . . . . . . . . . .   3
   4.  acr_values request and acr reponse  . . . . . . . . . . . . .   3
   5.  amr . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   6.  login_hint_token  . . . . . . . . . . . . . . . . . . . . . .   3
     6.1.  login_hint_token structure  . . . . . . . . . . . . . . .   3
   7.  Additional claims for the request object  . . . . . . . . . .   4
   8.  Specifying the truthyness of user claims  . . . . . . . . . .   4
   9.  Special claims for Mobile Operators as OpenID Providers . . .   4
   10. pair wise . . . . . . . . . . . . . . . . . . . . . . . . . .   4
   11. mandatory to implement  . . . . . . . . . . . . . . . . . . .   4
   12. Security Considerations . . . . . . . . . . . . . . . . . . .   5
   13. Privacy Considerations  . . . . . . . . . . . . . . . . . . .   5
   14. IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   15. Normative References  . . . . . . . . . . . . . . . . . . . .   5
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .   6
   Appendix B.  Notices  . . . . . . . . . . . . . . . . . . . . . .   6
   Appendix C.  Document History . . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7





Connotte & Bradley        Expires June 12, 2015                 [Page 1]

                 OIDC Mobile Authentication Profile 1.0         Dec 2014


1.  Introduction

   OpenID Connect Mobile Authentication Profile 1.0 is a profile of the
   OpenID Connect Core 1.0 [OpenID.Core] specification that defines
   common authentication contexts to be used across MNO and Mandatory to
   Implement features for MNO to assure interoperability of clients
   across MNO.

1.1.  Requirements Notation and Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   Throughout this document, values are quoted to indicate that they are
   to be taken literally.  When using these values in protocol messages,
   the quotes MUST NOT be used as part of the value.

1.2.  Terminology

   This specification uses the terms "Access Token", "Refresh Token",
   "Authorization Code", "Authorization Grant", "Authorization Server",
   "Authorization Endpoint", "Client", "Client Identifier", "Client
   Secret", "Protected Resource", "Resource Owner", "Resource Server",
   and "Token Endpoint" defined by OAuth 2.0 [RFC6749].  This
   specification also defines the following terms:

   Token Agent (TA)  A native application that obtains access tokens on
      behalf of other native applications - thereby enabling a Single
      SignOn experience for Native Application end users because the
      End-Users need only explicitly authenticate the _TA_ once per
      Authorization Server.

   AppInfo Endpoint  A protected resource that the _TA_ can call (using
      its primary access token) to obtain metadata corresponding to a
      set of applications - both web & native.  The _TA_ uses the
      application metadata in order to obtain secondary access tokens
      for those applications.

   Primary Token  An OAuth token (access, refresh, and id_token)
      obtained by the _TA_ for its own uses.

   Secondary Token  An OAuth access token obtained by the _TA_ on behalf
      of another native application.







Connotte & Bradley        Expires June 12, 2015                 [Page 2]

                 OIDC Mobile Authentication Profile 1.0         Dec 2014


2.  Overview

   Overview.

3.  Level of Assurance as acr_values

   JCO: what are the right acr values to reflect either legal
   indentities or pure digital identities?

   http://docs.oasis-open.org/security/saml/v2.0/saml-authn-context-
   2.0-os.pdf describes a number of possible acr corresponding to mobile
   environment i.e.
   urn:oasis:names:tc:SAML:2.0:ac:classes:MobileOneFactorUnregistered is
   referred to as

4.  acr_values request and acr reponse

   JCO: Reiteration of the corresponding values.  Support for at least
   Joe (credential level 1 to x) and/or John (identity level 1 to x)

5.  amr

   JCO: the amr response value must be considered in relation to the acr
   repsonse

6.  login_hint_token

   The request parameter login_hint_token is used to transport the
   MSISDN as a user identifier from the discovery service to the OpenID
   Provider in a way that the client get's no knowledge about the
   MSISDN.

6.1.  login_hint_token structure

   The value of the login_hint_token parameter is an Encrypted JSON web
   token (JWE) that contains the user hint for the issuer.  The token
   MUST be encrypted with the public key of the issuer.  This token is
   passed to the issuer in the authentication request.  This token
   contains the following elements:

   iss  The party creating the token.

   aud  The party to receive the token, typically the users OpenID
      Provider.  The value SHOULD be the "iss" URI of the OID.

   iat  When the token was issued.

   MSISDN  NUMERIC The Subscriber identifier



Connotte & Bradley        Expires June 12, 2015                 [Page 3]

                 OIDC Mobile Authentication Profile 1.0         Dec 2014


   The following is a non-normative example of JWT body (with line wraps
   within values for display purposes only):

     {
      "iss": "https://discovery-provider.com",
      "aud": "https://babytel.com",
      "iat": 1311280970,
      "MSISDN": "i5555551212"
       }
     }

7.  Additional claims for the request object

   Add specific claims to the request object such as a transaction
   message.  The request object MUST then be signed to prevent
   manipulating the transaction message

8.  Specifying the truthyness of user claims

   JCO: Something about how the claim was verified (self_asserted,
   proved).  Leads to a structure of claims.

9.  Special claims for Mobile Operators as OpenID Providers

   JCO: special claims

10.  pair wise

11.  mandatory to implement

   SPOP: symmetric proof of possession MANDATORY

   Mandatory support for private_key_jwt, SHOULD basic (section 9 of
   OpenID Connect) --> this implies public key exchange during
   registration.

   mandatory scopes (claims) as a question to the group.

   Support for account chooser: push login_hint_token to the account
   chooser

   asymmetric RSA signing for id_token --> publish jks-uri

   code flow, code id_token etc. optional

   login_hint_token to be implemented per the discovery spec





Connotte & Bradley        Expires June 12, 2015                 [Page 4]

                 OIDC Mobile Authentication Profile 1.0         Dec 2014


12.  Security Considerations

   TBD

13.  Privacy Considerations

   JCO: pair wise subject mandatory for Mobile Connect OpenID Provider.
   The RP can negotiate for the exact mechanism.

14.  IANA Considerations

   This document makes no requests of IANA.

   JCO: Is this true?  Didn't we talk about registering acr_values / acr
   at IANA?

15.  Normative References

   [JWT]      Jones, M., Bradley, J., and N. Sakimura, "JSON Web Token
              (JWT)", draft-ietf-oauth-json-web-token (work in
              progress), May 2013.

   [OpenID.Core]
              Sakimura, N., Bradley, J., Jones, M., de Medeiros, B.,
              Mortimore, C., and E. Jay, "OpenID Connect Core 1.0",
              December 2013.

   [OpenID.Discovery]
              Sakimura, N., Bradley, J., Jones, M., and E. Jay, "OpenID
              Connect Discovery 1.0", September 2014.

   [OpenID.Registration]
              Sakimura, N., Bradley, J., and M. Jones, "OpenID Connect
              Dynamic Client Registration 1.0", December 2013.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2246]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              RFC 2246, January 1999.

   [RFC5246]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", RFC 5246, August 2008.

   [RFC6749]  Hardt, D., "The OAuth 2.0 Authorization Framework", RFC
              6749, October 2012.





Connotte & Bradley        Expires June 12, 2015                 [Page 5]

                 OIDC Mobile Authentication Profile 1.0         Dec 2014


   [RFC6750]  Jones, M. and D. Hardt, "The OAuth 2.0 Authorization
              Framework: Bearer Token Usage", RFC 6750, October 2012.

Appendix A.  Acknowledgements

   The following have contributed to the development of this
   specification.



Appendix B.  Notices

   Copyright (c) 2014 The OpenID Foundation.

   The OpenID Foundation (OIDF) grants to any Contributor, developer,
   implementer, or other interested party a non-exclusive, royalty free,
   worldwide copyright license to reproduce, prepare derivative works
   from, distribute, perform and display, this Implementers Draft or
   Final Specification solely for the purposes of (i) developing
   specifications, and (ii) implementing Implementers Drafts and Final
   Specifications based on such documents, provided that attribution be
   made to the OIDF as the source of the material, but that such
   attribution does not indicate an endorsement by the OIDF.

   The technology described in this specification was made available
   from contributions from various sources, including members of the
   OpenID Foundation and others.  Although the OpenID Foundation has
   taken steps to help ensure that the technology is available for
   distribution, it takes no position regarding the validity or scope of
   any intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this specification or the extent to which any license under such
   rights might or might not be available; neither does it represent
   that it has made any independent effort to identify any such rights.
   The OpenID Foundation and the contributors to this specification make
   no (and hereby expressly disclaim any) warranties (express, implied,
   or otherwise), including implied warranties of merchantability, non-
   infringement, fitness for a particular purpose, or title, related to
   this specification, and the entire risk as to implementing this
   specification is assumed by the implementer.  The OpenID Intellectual
   Property Rights policy requires contributors to offer a patent
   promise not to assert certain patent claims against other
   contributors and against implementers.  The OpenID Foundation invites
   any interested party to bring to its attention any copyrights,
   patents, patent applications, or other proprietary rights that may
   cover technology that may be required to practice this specification.





Connotte & Bradley        Expires June 12, 2015                 [Page 6]

                 OIDC Mobile Authentication Profile 1.0         Dec 2014


Appendix C.  Document History

   [[ To be removed from the final specification ]]

   -01

   o  Initial draft

   o  Added OIDF Standard Notice

Authors' Addresses

   Joerg Connotte
   Deutsche Telekom AG

   Email: j.connotte@telekom.de


   John Bradley
   Ping Identity

   Email: jbradley@pingidentity.com





























Connotte & Bradley        Expires June 12, 2015                 [Page 7]
