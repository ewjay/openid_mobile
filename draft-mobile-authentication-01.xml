<?xml version="1.0" encoding="US-ASCII"?>
<?xml-stylesheet type='text/xsl' href='http://xml.resource.org/authoring/rfc2629.xslt' ?>
<!DOCTYPE rfc PUBLIC "-//IETF//DTD RFC 2629//EN"
"http://xml2rfc.ietf.org/authoring/rfc2629.dtd">
<!--
  NOTE:  This XML file is input used to produce the authoritative copy of an
  OpenID Foundation specification.  The authoritative copy is the HTML output.
  This XML source file is not authoritative.  The statement ipr="none" is
  present only to satisfy the document compilation tool and is not indicative
  of the IPR status of this specification.  The IPR for this specification is
  described in the "Notices" section.  This is a public OpenID Foundation
  document and not a private document, as the private="..." declaration could
  be taken to indicate.
-->
<rfc category="std" docName="draft-mobile-authentication-01" ipr="none">

  <?rfc toc="yes" ?>
  <?rfc tocdepth="5" ?>
  <?rfc symrefs="yes" ?>
  <?rfc sortrefs="yes"?>
  <?rfc strict="yes" ?>
  <?rfc iprnotified="no" ?>
  <?rfc private="Draft" ?>
  
  <front>
    <title abbrev="OIDC Mobile Authentication Profile 1.0">
            OpenID Connect Mobile Authentication Profile 1.0</title>


    <author fullname="Joerg Connotte" initials="J." surname="Connotte">
      <organization abbrev="">Deutsche Telekom AG</organization>
      <address>
        <email>j.connotte@telekom.de</email>
      </address>
    </author>


	<author fullname="John Bradley" initials="J." surname="Bradley">
      <organization abbrev="">Ping Identity</organization>
      <address>
        <email>jbradley@pingidentity.com</email>
      </address>
    </author>



    <date day="06" month="Sep" year="2015" />
    
    <workgroup>OpenID Mobile Profile Working Group</workgroup>

    <abstract>
    
<t>RPs are keen to use high quality authentication methods which can be provided by the 
MNOs. However a RP must be able to describe its demands for an authentication request 
and it must be able to do this interoperable.</t>

<t>The Mobile Profile will specify how RP's request a certain level of  assurance for the 
authentication. We propose to use the definition of Level of Assurance as specified in 
[6] as a starting point and define respective normative ACR values.
</t>



    </abstract>
  </front>

  <middle>

    <section anchor="Introduction" title="Introduction">

      <t>OpenID Connect Mobile Authentication Profile 1.0 is a profile of the 
      <xref target="OpenID.Core">OpenID Connect Core 1.0</xref> specification
      that defines common authentication contexts to be used across MNO and Mandatory to 
      Implement features for MNO to assure interoperability of clients across MNO.
      </t>

      <section anchor="rnc" title="Requirements Notation and Conventions">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <xref
        target="RFC2119"/>.</t>

        <t>Throughout this document, values are quoted to indicate that they are
        to be taken literally. When using these values in protocol messages, the
        quotes MUST NOT be used as part of the value.</t>
      </section>

      <section anchor="terminology" title="Terminology">
        <t>
          This specification uses the terms "Access Token", "Refresh Token",
          "Authorization Code", "Authorization Grant", "Authorization Server",
          "Authorization Endpoint", "Client", "Client Identifier", "Client Secret",
          "Protected Resource", "Resource Owner", "Resource Server", and
          "Token Endpoint" defined by <xref target="RFC6749">OAuth 2.0</xref>.
          This specification also defines the following terms: 
          <list style="hanging">
            <t hangText="Token Agent (TA)">
               A native application that obtains access tokens on behalf of other native applications - thereby enabling a Single SignOn
               experience for Native Application end users because the End-Users need only explicitly authenticate the <spanx style="emph">TA</spanx> once per Authorization Server.
            </t>
            <t hangText="AppInfo Endpoint">
                A protected resource that the <spanx style="emph">TA</spanx> can call 
                (using its primary access token) to obtain metadata corresponding to a set 
                of applications - both web &amp; native. The <spanx style="emph">TA</spanx> 
                uses the application metadata in order to obtain secondary access tokens 
                for those applications.
            </t>
             <t hangText="Primary Token">
              An OAuth token (access, refresh, and id_token) obtained by 
              the <spanx style="emph">TA</spanx> for its own uses. 
            </t>
             <t hangText="Secondary Token">
              An OAuth access token obtained by the <spanx style="emph">TA</spanx> on behalf of 
              another native application. 
            </t>
          </list>
        </t>
      </section>
    </section>
    
    <section anchor="overview" title="Overview">
    
    <t>
	    This specification serves as a profile based on OpenID Connect Core <xref target="OpenID.Core"/>.
	    It defines additional request parameters in the Authentication Request.
	    It specifies authentication class reference values based on the
	    ISO/IEC DIS 29115 <xref target="ISO.29115"/>
	</t>


    </section>
	<section anchor="auth_request" title="Authentication Request">
		<t>
			<list style="hanging">
				<t hangText="acr_values">
					REQUIRED. For MODRNA the parameter is REQUIRED to enable the Relying Party to 
					indicate a MODRNA conform authentication request. 
				</t>
				<t hangText="login_hint_token">
					OPTIONAL. A parameter to be passed in the authentication request. 
					The login_hint_token is used to 
    	        	transport a user identifier from the discovery service to the OpenID Provider without 
        	    	revealing this identifier to the client.
				</t>
				<t hangText="context">
				    OPTIONAL. Interlock message to tie the consumption device and 
				    the authentication device together.
				    How to ensure that the message is actually shown on all relevant 
				    devices is out of the scope of this document.
				</t>
			</list>
		</t>
		<t>
			MODRNA also supports all request parameters as specified in 
			OpenID Connect Core 3.1.2.1 <xref target="OpenID.Core"/>
		</t>
	</section>
    <section anchor="acr_values" title="acr_values request values and level of assurance">
        <t>
	        TBD: Reiteration of the corresponding values. Support for at least Joe
         	(credential level 1 to x) and/or John (identity level 1 to x)
        </t>
        <t>
	        TBD: After discussion the acr_values have to reflect the level of assurance as
	    	specified in ISO 29115. An urn is used to be able to register to IANA.
	    	TBD: Do we have to specify the actual methodologies here? 
	    </t>
	    <t>
		    <list style="hanging">
			    <t hangText="urn:modrna:acr:credential:loa1">
				    ISO 29115: Litte or no confidence in the asserted identity. 
				    No verification of the posted credentials is performed.
				    
			    </t>
			    <t hangText="urn:modrna:acr:credential:loa2">
				    ISO 29115: Some confidence in the asserted identity
				    Single factor authentication is performed.
			    </t>
			    <t hangText="urn:modrna:acr:credential:loa3">
				    ISO 29115: High confidence in the asserted identity
				    Multi-factor authentication shall be used.
			    </t>
			    <t hangText="urn:modrna:acr:credential:loa4">
				    ISO 29115: Very high confidence in the asserted identity
				    The use of tamper-resistant hardware devices for the storage of all 
				    cryptrographic keys.
			    </t>
			</list>
		</t>		    
    </section>
    
    <section anchor="login_hint_token_structure" title="login_hint_token">
		<t>
        	The login_hint_token is a Json Web Token <xref target="JWT"/> that contains 
        	the following elements:
            <list style="hanging">
                <t hangText="iss">
			        REQUIRED. The party creating the token.
			        This value MUST be a URI to allow for signature validation
			        TBD: is signing mandatory? 
			    </t>
			    <t hangText="aud">
                    REQUIRED. The party to receive the token, typically the users OpenID Provider.
                    The value SHOULD be the issuer URI of the OID as exposed 
                    in the openid-configuration.
   			    </t>
	      		<t hangText="iat"> 
                    REQUIRED. When the token was issued.
			    </t>
			    <t hangText="MSISDN"> REQUIRED. NUMERIC 
			        The Subscriber identifier
			        TBD: according to what standard?
                </t>	
             </list>
         </t>
         <figure>
	     	<preamble>The following is a non-normative example of JWT body 
	        (with line wraps within values for display purposes only):</preamble>
			<artwork><![CDATA[
  {
   "iss": "https://discovery-provider.com",
   "aud": "https://babytel.com",
   "iat": 1311280970,
   "MSISDN": "5555551212"
    }
  }
                ]]></artwork>
		</figure>
    </section>

    <section anchor="lht_encryption_signing" title="login_hint_token encryption and signing">
        <t>
	        The login_hint token MUST be encrypted using the public key of the OpenID Provider.
        	The login_hint token MUST be signed using the private key of the discovery service.
        	TBD: it would follow that the 'iss' claim is mandatory and must allow for 
        	signature validation.
        </t>
    </section>

    <section anchor="request_object_claims" title="Additional claims for the request object">
    	<t>
	    	Add specific claims to the request object such as a transaction message. 
    		The request object MUST then be signed to prevent manipulating the transaction message
		    <list style="hanging">
			    <t hangText="context">
				    TBD: add the definition of an OPTIONAL parameter 'context'
			    </t>
			</list>
    	</t>
    </section>

    <section anchor="claim_validity" title="Specifying the truthyness of user claims">
        <t>TBD: Something about how the claim was verified (self_asserted, proved).
         Leads to a structure of claims.</t>
    </section>
    <section anchor="mno_claims" title="Special claims for Mobile Operators as OpenID Providers">
        <t>TBD: special claims</t>
        <t hangText=""></t>
    </section>
    
    <section anchor="pair_wise" title="pair wise ">
        <t></t>
    </section>
    <section anchor="m_t_i" title="mandatory to implement">
        <t>SPOP: symmetric proof of possession MANDATORY</t>
        <t>Mandatory support for private_key_jwt, SHOULD basic (section 9 of OpenID Connect) 
	        --> this implies public key exchange during registration.</t>
        <t>mandatory scopes (claims) as a question to the group.</t>
        <t>Support for account chooser: push login_hint_token to the account chooser</t>
        <t>asymmetric RSA signing for id_token --> publish jks-uri</t>
        <t>code flow, code id_token etc. optional</t>
        <t>login_hint_token to be implemented per the discovery spec</t>
    </section>
    

    <section anchor="security_considerations" title="Security Considerations">
	<t>TBD</t>
    </section>

    <section anchor="privacy_considerations" title="Privacy Considerations">
	<t>TBD: pair wise subject mandatory for Mobile Connect OpenID Provider. 
		The RP can negotiate for the exact mechanism. </t>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>This document makes no requests of IANA.</t>
      <t>TBD: Is this true? Didn't we talk about registering acr_values / acr at IANA?</t>
    </section>

  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119"?>
      <?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6749"?>
      <?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6750"?>
      <?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5246"?>
      <?rfc include="http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2246"?>


      
      <reference anchor="OpenID.Core">
	<front>
	  <title>OpenID Connect Core 1.0</title>

	  <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
	    <organization abbrev="NRI">Nomura Research Institute, Ltd.</organization>
	  </author>

	  <author fullname="John Bradley" initials="J." surname="Bradley">
	    <organization abbrev="Ping Identity">Ping Identity</organization>
	  </author>

	  <author fullname="Michael B. Jones" initials="M.B." surname="Jones">
	    <organization abbrev="Microsoft">Microsoft</organization>
	  </author>

	  <author fullname="Breno de Medeiros" initials="B." surname="de Medeiros">
	    <organization abbrev="Google">Google</organization>
	  </author>

	  <author fullname="Chuck Mortimore" initials="C." surname="Mortimore">
	    <organization abbrev="Salesforce">Salesforce</organization>
	  </author>

	  <author fullname="Edmund Jay" initials="E." surname="Jay">
	    <organization abbrev="Illumila">Illumila</organization>
	  </author>

	  <date day="19" month="December" year="2013"/>
	</front>

	<format target="http://openid.net/specs/openid-connect-core-1_0.html"
		type="HTML" />
      </reference>


      <reference anchor="OpenID.Discovery">
	<front>
	  <title>OpenID Connect Discovery 1.0</title>

	  <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
	    <organization abbrev="NRI">Nomura Research Institute, Ltd.</organization>
	  </author>

	  <author fullname="John Bradley" initials="J." surname="Bradley">
	    <organization abbrev="Ping Identity">Ping Identity</organization>
	  </author>

	  <author fullname="Michael B. Jones" initials="M.B." surname="Jones">
	    <organization abbrev="Microsoft">Microsoft</organization>
	  </author>

	  <author fullname="Edmund Jay" initials="E." surname="Jay">
	    <organization abbrev="Illumila">Illumila</organization>
	  </author>

	  <date day="16" month="September" year="2014"/>
	</front>

	<format target="http://openid.net/specs/openid-connect-discovery-1_0.html"
		type="HTML" />
      </reference>

      <reference anchor="JWT">
        <front>
          <title>JSON Web Token (JWT)</title>

          <author fullname="Michael B. Jones" initials="M.B." surname="Jones">
            <organization abbrev="Microsoft">Microsoft</organization>
          </author>

          <author fullname="John Bradley" initials="J." surname="Bradley">
           <organization abbrev="Ping Identity">Ping Identity</organization>
          </author>

          <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
            <organization abbrev="NRI">Nomura Research Institute, Ltd.</organization>
          </author>

          <date day="28" month="May" year="2013" />
        </front>

	<seriesInfo value="draft-ietf-oauth-json-web-token" name="Internet-Draft"/>
	<format target="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08"
                type="HTML" />
      </reference>

      <reference anchor="ISO.29115">
	<front>
	  <title>ISO/IEC DIS 29115</title>

          <author fullname="Erika McCallister" initials="E." surname="McAllister">
           <organization abbrev="ISO">ISO</organization>
          </author>

          <author fullname="Richard Brackney" initials="R." surname="Brackney">
            <organization abbrev="ITU-T">ITU-T</organization>
          </author>

	  <date day="01" month="April" year="2013"/>
	</front>

	<format target="http://www.iso.org/iso/catalogue_detail.htm?csnumber=45138"
		type="HTML" />
      </reference>
      
    </references>
    

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>The following have contributed to the development of this specification.</t>
      <t>
        <list style="empty">
          <t></t>
        </list>
      </t>
    </section>


    <section anchor="Notices" title="Notices">
      <t>Copyright (c) 2014 The OpenID Foundation.</t>
      <t>
	The OpenID Foundation (OIDF) grants to any Contributor, developer, 
	implementer, or other interested party a non-exclusive, royalty free, 
	worldwide copyright license to reproduce, prepare derivative works from, 
	distribute, perform and display, this Implementers Draft or 
	Final Specification solely for the purposes of (i) developing 
	specifications, and (ii) implementing Implementers Drafts and 
	Final Specifications based on such documents, provided that attribution 
	be made to the OIDF as the source of the material, but that such attribution 
	does not indicate an endorsement by the OIDF.
      </t>
      <t>
	The technology described in this specification was 
	made available from contributions from various sources, 
	including members of the OpenID Foundation and others.  
	Although the OpenID Foundation has taken steps to help ensure 
	that the technology is available for distribution, it takes 
	no position regarding the validity or scope of any intellectual 
	property or other rights that might be claimed to pertain to 
	the implementation or use of the technology described in 
	this specification or the extent to which any license under 
	such rights might or might not be available; neither does it 
	represent that it has made any independent effort to identify 
	any such rights.  The OpenID Foundation and the contributors 
	to this specification make no (and hereby expressly disclaim any) 
	warranties (express, implied, or otherwise), including implied 
	warranties of merchantability, non-infringement, fitness for 
	a particular purpose, or title, related to this specification, 
	and the entire risk as to implementing this specification is 
	assumed by the implementer.  The OpenID Intellectual 
	Property Rights policy requires contributors to offer 
	a patent promise not to assert certain patent claims against 
	other contributors and against implementers.  The OpenID Foundation invites 
	any interested party to bring to its attention any copyrights, 
	patents, patent applications, or other proprietary rights 
	that may cover technology that may be required to practice 
	this specification.
      </t>
    </section>


    <section anchor="History" title="Document History">
      <t>[[ To be removed from the final specification ]]</t>

      <t>-01 <list style="symbols">
          <t>Initial draft</t>
          <t>Added OIDF Standard Notice </t>
        </list></t>
        
          
    
    </section>
  </back>
</rfc>
